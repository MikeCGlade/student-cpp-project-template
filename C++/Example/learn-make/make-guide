Learn Make Guide: https://www.gnu.org/software/make/manual/make.html#Overview

Overview:

#1
    Variables:
    target: dependencies
    <TAB>command

    Example:
    CXX = g++
    CXXFLAGS = -Wall -Wextra -std=c++17 -Isrc
    TARGET = app.exe
    BUILD_DIR = build

    Why variables?

    Change compiler once

    Add flags safely

    Easier to read & edit later

#2
    Directory Operations:

    SRCS = main.cpp $(wildcard src/*.cpp)

    What is wildcard?

    Asks make: ‚Äúgive me all .cpp files in src/‚Äù

#3
    Output:
    .cpp ‚Üí .o ‚Üí .exe

    OBJS = $(BUILD_DIR)/main.o \
        $(patsubst src/%.cpp,$(BUILD_DIR)/%.o,$(wildcard src/*.cpp))

    Example:
    src/foo.cpp ‚Üí build/foo.o

#4
    Target:

    all: $(TARGET)

    The first target is the default.

    So:

    mingw32-make


    means:

    mingw32-make all

#5
    Linking:

    $(TARGET): $(OBJS)
        $(CXX) $(CXXFLAGS) -o $@ $(OBJS)

    Automatic variables
    Variable	Meaning
    $@	target name (app.exe)
    $<	first dependency
    $^	all dependencies

    You can rewrite as:

    g++ -o app.exe build/main.o build/foo.o ...

#6 
    Hidden Rule:

    $(BUILD_DIR):
        if not exist $(BUILD_DIR) mkdir $(BUILD_DIR)

#7
    main.cpp
    $(BUILD_DIR)/main.o: main.cpp | $(BUILD_DIR)
        $(CXX) $(CXXFLAGS) -c $< -o $@

    src files
    $(BUILD_DIR)/%.o: src/%.cpp | $(BUILD_DIR)
        $(CXX) $(CXXFLAGS) -c $< -o $@

    The vertical bar |

    This means:

    ‚Äúbuild/ must exist, but don‚Äôt rebuild if it changes.‚Äù

    This is advanced make, and you‚Äôre already using it.

#8 
    Cleaning

    clean:
	del /Q $(BUILD_DIR)\*.o $(TARGET)

    Special targets like clean:

    don‚Äôt produce files

    are manually invoked

Run: 
    How to experiment safely
    1Ô∏è‚É£ Dry run (no execution)
    mingw32-make -n

    2Ô∏è‚É£ Debug make logic
    mingw32-make --debug=b

    3Ô∏è‚É£ Print variables
    print:
        @echo SRCS=$(SRCS)
        @echo OBJS=$(OBJS)


    Run:

    mingw32-make print

Clues: 
    üß© How to modify it yourself (cheat sheet)
    Add another source folder
    SRCS += $(wildcard lib/*.cpp)

    Add optimization
    CXXFLAGS += -O2

    Debug build
    CXXFLAGS += -g

    Change output name
    TARGET = myprogram.exe

    üèÅ Mental Model (important)

    Think in graphs, not scripts:

    main.cpp ‚îÄ‚îÄ‚ñ∂ main.o ‚îÄ‚îê
    foo.cpp  ‚îÄ‚îÄ‚ñ∂ foo.o  ‚îú‚îÄ‚ñ∂ app.exe
    bar.cpp  ‚îÄ‚îÄ‚ñ∂ bar.o  ‚îò


    Make only rebuilds what changed.









